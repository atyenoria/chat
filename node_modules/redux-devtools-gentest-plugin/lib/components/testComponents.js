'use strict';

exports.__esModule = true;

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }

function _inherits(subClass, superClass) { if (typeof superClass !== 'function' && superClass !== null) { throw new TypeError('Super expression must either be null or a function, not ' + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

var _react = require('react');

var _react2 = _interopRequireDefault(_react);

var _reactPureRenderComponent = require('react-pure-render/component');

var _reactPureRenderComponent2 = _interopRequireDefault(_reactPureRenderComponent);

var _jsHelpers = require('./jsHelpers');

var _ramda = require('ramda');

var _ramda2 = _interopRequireDefault(_ramda);

var _jquery = require('jquery');

var _jquery2 = _interopRequireDefault(_jquery);

var Expect = (function (_PureComponent) {
    _inherits(Expect, _PureComponent);

    function Expect() {
        _classCallCheck(this, Expect);

        _PureComponent.apply(this, arguments);
    }

    Expect.prototype.render = function render() {
        var stateNextId = _react2['default'].createElement(
            'span',
            null,
            JSON.stringify(this.props.nextState)
        );
        var stateId = _react2['default'].createElement(
            'span',
            null,
            JSON.stringify(this.props.curState)
        );
        var action = _react2['default'].createElement(
            'span',
            null,
            JSON.stringify(this.props.action)
        );
        return _react2['default'].createElement(
            'span',
            null,
            'const curState = ',
            stateId,
            ';',
            _react2['default'].createElement('br', null),
            'const action = ',
            action,
            ';',
            _react2['default'].createElement('br', null),
            'const nextState = ',
            stateNextId,
            ';',
            _react2['default'].createElement('br', null),
            'const computedNextState = reducer(curState, action);',
            _react2['default'].createElement('br', null),
            'expect(computedNextState).to.deep.equal(nextState);',
            _react2['default'].createElement('br', null)
        );
    };

    return Expect;
})(_reactPureRenderComponent2['default']);

exports.Expect = Expect;

var It = (function (_PureComponent2) {
    _inherits(It, _PureComponent2);

    function It() {
        _classCallCheck(this, It);

        _PureComponent2.apply(this, arguments);
    }

    It.prototype.render = function render() {
        var computedStateNextId = _react2['default'].createElement(
            'span',
            null,
            'check computedState_',
            this.props.action.type,
            '_',
            this.props.index,
            ' evaluation'
        );
        return _react2['default'].createElement(
            'span',
            null,
            'it(\'',
            computedStateNextId,
            '\', () =>',
            _react2['default'].createElement(_jsHelpers.Begin, null),
            _react2['default'].createElement('br', null),
            _react2['default'].createElement(Expect, this.props),
            _react2['default'].createElement(_jsHelpers.End, null),
            ');'
        );
    };

    return It;
})(_reactPureRenderComponent2['default']);

exports.It = It;

var Describe = (function (_PureComponent3) {
    _inherits(Describe, _PureComponent3);

    function Describe() {
        _classCallCheck(this, Describe);

        _PureComponent3.apply(this, arguments);
    }

    Describe.prototype.componentDidUpdate = function componentDidUpdate() {
        if (!this.props.onNewText) return;
        var str = _jquery2['default'](_react2['default'].findDOMNode(this)).html();
        var regex = /<br .*?>/g;
        var res = _jquery2['default'](_jquery2['default'].parseHTML(str.replace(regex, '\n'))).text();
        this.props.onNewText(res);
    };

    Describe.prototype.render = function render() {

        var its = _ramda2['default'].map(function (item) {
            return _react2['default'].createElement(
                'span',
                null,
                _react2['default'].createElement(It, item),
                _react2['default'].createElement('br', null),
                _react2['default'].createElement('br', null)
            );
        })(this.props.items);
        return _react2['default'].createElement(
            'span',
            null,
            'import chai from "chai";',
            _react2['default'].createElement('br', null),
            'import ',
            _react2['default'].createElement(_jsHelpers.Begin, null),
            ' combineReducers ',
            _react2['default'].createElement(_jsHelpers.End, null),
            ' from \'redux\';',
            _react2['default'].createElement('br', null),
            'import * as reducers from \'../reducers\';',
            _react2['default'].createElement('br', null),
            _react2['default'].createElement('br', null),
            'const reducer = combineReducers(reducers);',
            _react2['default'].createElement('br', null),
            'const expect = chai.expect;',
            _react2['default'].createElement('br', null),
            _react2['default'].createElement('br', null),
            'describe(\'handleActions\', () => ',
            _react2['default'].createElement(_jsHelpers.Begin, null),
            _react2['default'].createElement('br', null),
            _react2['default'].createElement('br', null),
            its,
            _react2['default'].createElement('br', null),
            _react2['default'].createElement(_jsHelpers.End, null),
            ');',
            _react2['default'].createElement('br', null)
        );
    };

    return Describe;
})(_reactPureRenderComponent2['default']);

exports.Describe = Describe;